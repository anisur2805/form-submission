(()=>{"use strict";var e,t={62:()=>{const e=window.wp.blocks,t=window.React,n=window.wp.i18n,a=window.wp.blockEditor,l=e=>{const{current_page:a,total_pages:l,onChangePage:r,showPagi:o}=e;return(0,t.createElement)("div",{className:"afs-footer-pagination"},o&&(0,t.createElement)("div",{className:"pagination"},a>1&&(0,t.createElement)("button",{className:"prev-btn",onClick:()=>r(a-1)},(0,n.__)("<< Previous","afs-form")),(()=>{const e=[];for(let n=1;n<=l;n++)e.push((0,t.createElement)("button",{key:n,onClick:()=>r(n),className:"page-numbers "+(a===n?" current ":"")},n));return e})(),a<l&&(0,t.createElement)("button",{className:"next-btn",onClick:()=>r(a+1)},(0,n.__)("Next >>","afs-form"))))},r=window.wp.components,o=window.wp.primitives,s=(0,t.createElement)(o.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,t.createElement)(o.Path,{d:"M4 9v1.5h16V9H4zm12 5.5h4V13h-4v1.5zm-6 0h4V13h-4v1.5zm-6 0h4V13H4v1.5z"})),{useState:c,useEffect:i}=wp.element;function m({rowsPerPage:e,setAttributes:o}){const[m,u]=c(!0),[g,p]=c(!0),[d,f]=c({data:[],current_page:1,per_page:10,total_pages:5});return i((()=>{(async()=>{try{const t=await fetch(`/wp-json/afs-forms/v1/reports?per_page=${e}&page=${d.current_page}`,{headers:{"Content-Type":"application/json","X-WP-Nonce":afsFormObj.nonce},credentials:"same-origin"}),n=t.headers.get("X-WP-TotalPages");if(!t.ok)throw new Error(`Error fetching data: ${t.statusText}`);const a=await t.json();f((e=>({...e,data:a,total_pages:n}))),p(!1)}catch(e){p(!1)}})()}),[d.current_page,d.per_page,e]),(0,t.createElement)("div",null,(0,t.createElement)(a.InspectorControls,null,(0,t.createElement)(r.PanelBody,{className:"afs-report-table-panel-body",title:(0,n.__)("Report Table Settings","afs-form"),icon:s,initialOpen:!0},(0,t.createElement)(r.PanelRow,null,(0,t.createElement)(r.RangeControl,{label:(0,n.__)("Rows Per Page","afs-fs"),value:e,min:"1",onChange:e=>{o({rowsPerPage:e})}})),(0,t.createElement)(r.PanelRow,null,(0,t.createElement)(r.ToggleControl,{label:(0,n.__)("Toggle Pagination","afs-fs"),checked:m,onChange:e=>{u(e),o({showPagination:e})}})))),(0,t.createElement)("table",{class:"afs-report-table"},(0,t.createElement)("thead",null,(0,t.createElement)("tr",null,(0,t.createElement)("th",null,(0,n.__)("ID","afs-fs")),(0,t.createElement)("th",null,(0,n.__)("Amount","afs-fs")),(0,t.createElement)("th",null,(0,n.__)("Buyer","afs-fs")),(0,t.createElement)("th",null,(0,n.__)("Receipt ID","afs-fs")),(0,t.createElement)("th",null,(0,n.__)("Buyer Email","afs-fs")),(0,t.createElement)("th",null,(0,n.__)("Entry Date","afs-fs")))),(0,t.createElement)("tbody",null,g&&(0,t.createElement)("tr",null,(0,t.createElement)("td",{colSpan:"6"},(0,n.__)("Report data loading...","afs-fs"))),!g&&d&&(Array.isArray(d.data)?d.data.map((e=>(0,t.createElement)("tr",{key:e.id},(0,t.createElement)("td",null,e.id),(0,t.createElement)("td",null,e.amount),(0,t.createElement)("td",null,e.buyer),(0,t.createElement)("td",null,e.receipt_id),(0,t.createElement)("td",null,e.buyer_email),(0,t.createElement)("td",null,e.entry_at)))):d.map((e=>(0,t.createElement)("tr",{key:e.id},(0,t.createElement)("td",null,e.id),(0,t.createElement)("td",null,e.amount),(0,t.createElement)("td",null,e.buyer),(0,t.createElement)("td",null,e.receipt_id),(0,t.createElement)("td",null,e.buyer_email),(0,t.createElement)("td",null,e.entry_at))))),!g&&(!d||(Array.isArray(d.data)?0===d.data.length:0===d.length))&&(0,t.createElement)("tr",null,(0,t.createElement)("td",{colSpan:"6"},(0,n.__)("No report found","afs-fs"))))),(0,t.createElement)(l,{current_page:d.current_page,total_pages:d.total_pages,onChangePage:e=>{f((t=>({...t,current_page:e})))},showPagi:m}))}const u=JSON.parse('{"u2":"afs-gutenberg-block/report-table"}');(0,e.registerBlockType)(u.u2,{edit:function({attributes:e,className:l,setAttributes:r}){return(0,t.createElement)("div",{...(0,a.useBlockProps)()},(0,t.createElement)(a.BlockControls,null,(0,t.createElement)(a.AlignmentToolbar,{value:e.titleAlignment,onChange:e=>{r({titleAlignment:void 0===e?"none":e})}})),(0,t.createElement)(a.RichText,{tagName:"h2",className:"report-title",style:{textAlign:e.titleAlignment},value:e.title,onChange:e=>{r({title:e})},placeholder:(0,n.__)("Report Table","afs-fs")}),(0,t.createElement)(a.BlockControls,null,(0,t.createElement)(a.AlignmentToolbar,{value:e.contentAlignment,onChange:e=>{r({contentAlignment:void 0===e?"none":e})}})),(0,t.createElement)(a.RichText,{className:"report-content",tagName:"p",style:{textAlign:e.contentAlignment},value:e.content,onChange:e=>r({content:e}),placeholder:(0,n.__)("This list is only visible for logged-in and minimum of Editor roles.","afs-fs")}),(0,t.createElement)(m,{rowsPerPage:e.rowsPerPage,showPagination:e.showPagination,setAttributes:r}))},save:function({attributes:e}){const n=a.useBlockProps.save();return(0,t.createElement)("div",{...n})}})}},n={};function a(e){var l=n[e];if(void 0!==l)return l.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,a),r.exports}a.m=t,e=[],a.O=(t,n,l,r)=>{if(!n){var o=1/0;for(m=0;m<e.length;m++){for(var[n,l,r]=e[m],s=!0,c=0;c<n.length;c++)(!1&r||o>=r)&&Object.keys(a.O).every((e=>a.O[e](n[c])))?n.splice(c--,1):(s=!1,r<o&&(o=r));if(s){e.splice(m--,1);var i=l();void 0!==i&&(t=i)}}return t}r=r||0;for(var m=e.length;m>0&&e[m-1][2]>r;m--)e[m]=e[m-1];e[m]=[n,l,r]},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={78:0,713:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var l,r,[o,s,c]=n,i=0;if(o.some((t=>0!==e[t]))){for(l in s)a.o(s,l)&&(a.m[l]=s[l]);if(c)var m=c(a)}for(t&&t(n);i<o.length;i++)r=o[i],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(m)},n=globalThis.webpackChunkafs_gutenberg_block=globalThis.webpackChunkafs_gutenberg_block||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var l=a.O(void 0,[713],(()=>a(62)));l=a.O(l)})();